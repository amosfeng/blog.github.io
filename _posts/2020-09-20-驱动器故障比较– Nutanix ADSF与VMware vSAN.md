---
title: 驱动器故障比较– Nutanix ADSF与VMware vSAN
tags:
  - Technical Comparative Analysis
---
#### 在本篇文章中，我们来分享讨论如果节点的驱动器硬盘发生故障，对Nutanix ADSF与VMware vSAN分别会有怎样的影响。
目前市场上主流的x86服务器，提供12*3.5‘ 或 24*2.5’ 盘位。
<div align=center>下图显示了带有12个3.5英寸驱动器托架的x86服务器的正面。<img src ="/assets/images/12x3.5.jpg"/></div>

<div align=center>下图显示了带有24个2.5英寸驱动器托架的x86服务器的正面。<img src ="/assets/images/24x2.5.jpg"/></div>
我们还将对vSAN配置使用两个磁盘组，因为这是VxRail E系列上vSAN可能具有的最具弹性的配置。有趣的是，您实际上别无选择，只能使用两个磁盘组，因为一个磁盘组最多只能支持7个容量的驱动器……我们将在以后的文章中讨论此限制。

对于不熟悉Nutanix的用户，没有类似于磁盘组的概念/复杂性，所有驱动器都是集群范围或“全局”存储池的一部分。

Nutanix也没有“高速缓存”驱动器的概念，所有驱动器都是存储池的一部分，对于闪存设备，所有驱动器都有助于持久写入缓冲区（oplog），以改善驱动器的磨损，弹性和性能。

此问题也适用于弹性，在此讨论中，驱动器故障。让我举一个简单的例子：

容错能力	Nutanix	VMware vSAN
丢失任何1个SSD / HDD（RF2 / FTT1）	✅	✅
丢失任何2个SSD / HDD（RF3 / FTT2）	✅	✅
从复选框比较中可以看出，两个平台都可以通过配置Nutanix弹性因子RF2 / vSAN故障以容忍FTT1以及两个并发SSD / HDD故障（通过使用Nutanix RF3或vSAN）来容忍任何SSD / HDD故障FTT2。

如果发生这些故障，两种产品都可以执行自我修复。

容错能力	Nutanix	VMware vSAN
驱动器故障后自愈（RF2 / FTT1）	✅	✅
两次驱动器故障后自愈（RF3 / FTT2）	✅	✅
到目前为止，一切都很好！

好吧……不是真的，因为失败的影响取决于vSAN / VxRail的配置方式而有很大的不同，而Nutanix平台上的失败则不管配置如何都得到一致处理。

示例1：vSAN“缓存”驱动器故障

使用vSAN，在两个磁盘组配置中，VMware建议使用两个磁盘组配置来提高弹性和性能，单个“缓存”驱动器故障会使整个磁盘组脱机！

在最常见的DellEMC VxRail平台中，具有两个磁盘组（每个磁盘组1个缓存驱动器和4个容量驱动器），单个缓存驱动器故障导致5个驱动器脱机并需要重建。那是5 x 1.92TB驱动器的容量损失，需要通过vSAN进行重建。

使用Nutanix，任何单个驱动器故障都与您预期的一样，单个驱动器故障和仅一个单个1.92TB驱动器需要重建。

在此示例中，Nutanix的影响比vSAN低5倍。

在这一点上，您可能已经确定vSAN并非是可行的，但是请继续阅读，因为您将有空闲时间，因为您正在部署Nutanix。

示例2：使用重复数据删除和压缩功能时vSAN驱动器出现故障

使用重复数据删除和压缩功能时，如果高速缓存驱动器发生故障，则磁盘组仍会脱机，如示例1所述，但是如果vSAN容量驱动器发生故障，则还会丢失整个磁盘组！

参考：https : //docs.vmware.com/cn/VMware-vSphere/6.7/com.vmware.vsphere.virtualsan.doc/GUID-3D2D80CC-444E-454E-9B8B-25C3F620EFED.html

使用Nutanix，情况保持一致，并且如您所料，单个驱动器故障只会导致需要重建单个1.92TB驱动器。

在示例2中，Nutanix的影响再次比vSAN低5倍！

还在看书还是在享受Nutanix PRISM GUI？

示例3：vSAN缺乏分布式粒度重建

vSAN受其底层“对象存储”设计的约束，该设计可存储最大255GB的对象并在同一级别进行重建。

这意味着vSAN也受限于它可以在何处重建对象，因为它需要足够的容量来存储每个对象。不仅由于对象到对象的重建实际上是从一个驱动器到另一个驱动器（即：2个闪存设备和2个节点）而导致性能降低，而且还会发生碎片，这就是VMware建议25-30％的空闲空间的原因，如前所述。

这意味着vSAN的可用容量比Nutanix少，重建速度也较慢。

参考：https : //storagehub.vmware.com/t/vmware-vsan-6-7-technical-overview/object-rebuilding-resynchronization-consolidation-1/

对于您要求的重建，Nutanix如何优于vSAN？

Nutanix以4MB的粒度执行重建，并且没有大型对象的约束。虚拟磁盘仅由所需的4MB扩展区组组成，并且根据整个集群的性能和容量进行分配。这意味着对于Nutanix重建，群集中的所有节点和所有驱动器都有助于单个驱动器的重建，从而使其速度更快，影响更小，并在群集容量方面更加平衡。

有关Nutanix重建速度的示例，请查看我于2018年发表的关于节点重建性能的文章，该文章显示Nutanix ADSF非常高效，可以执行接近物理SSD最高性能的重建。

如果您仍在考虑vSAN，示例4将改变您的想法。

示例4：维护和故障期间的vSAN I / O完整性

Nutanix与vSAN相比，主要的弹性优势在于，事实是ADSF始终遵守已配置的弹性因子，包括在所有故障和维护方案期间。

但是，vSAN不会在所有主机维护和故障情况下维持其配置的FTT级别。对于在vSAN上配置了FTT = 1的VM，如果托管一个vSAN磁盘“对象”的主机脱机进行维护，则新的覆盖不会受到保护，因此单个驱动器故障会导致数据丢失。如果某个节点处于脱机状态以进行维护，并且客户未选择从该节点撤离所有数据，则写入操作也不会符合“无法容忍（FTT）”策略。

欲了解更多详情请查看维护或故障期间，写I / O -第6部分的我弹性系列。

摘要

Nutanix对驱动器故障的影响要小得多
使用Nutanix，单个驱动器故障仅影响单个驱动器，而不影响一组驱动器（单个SSD节点除外）
无论采用何种数据效率技术，Nutanix驱动器故障的处理方式均相同
Nutanix在故障方案和维护期间始终保持写入I / O完整性
Nutanix的恢复速度更快，而故障带来的影响则更低
在某些维护和故障情况下，vSAN不能保持数据弹性，而Nutanix总是可以。
接下来，我们看一下异构集群支持– Nutanix与VMware vSAN
